# 高校自习室预约平台后端系统

## 项目描述

### 1. 项目概述

该项目是一个高校自习室预约平台的后端系统，旨在为学生提供便捷的自习室预约服务，同时为管理员提供全面的系统管理功能。系统采用Spring Boot 3.1.5 + Java 17开发，使用MyBatis-Plus进行数据访问，Spring Security + JWT实现认证授权，Redis用于缓存和Token管理。

### 2. 核心功能模块

#### 2.1 认证模块（Auth）

- 用户登录、注册、刷新令牌
- 密码修改、重置
- 实名认证
- Token管理与登出

#### 2.2 用户模块（User）

- 管理员账户管理
- 学生用户管理
- 个人信息更新
- 信用分管理

#### 2.3 自习室模块（Room）

- 自习室管理（创建、更新、删除、查询）
- 座位管理（批量创建、状态更新、布局管理）
- 房间状态查询
- 座位可用性检查

#### 2.4 预约模块（Reservation）

- 预约创建、取消、查询
- 预约状态管理
- 座位可用性检查
- 预约冲突检测
- 预约费用计算

#### 2.5 签到与违规模块（CheckIn & Violation）

- 签到、签出、暂离、回来
- 二维码生成与验证
- 违规记录与处理
- 签到统计

#### 2.6 统计模块（Statistics）

- 系统总体统计
- 房间使用情况统计
- 用户使用情况统计
- 预约热力图分析
- 时间段使用统计
- 数据导出

#### 2.7 通知模块（Notification）

- 系统通知管理
- 通知发送

### 3. 技术架构

#### 3.1 技术栈

- **后端框架**：Spring Boot 3.1.5
- **编程语言**：Java 17
- **数据访问**：MyBatis-Plus 3.5.4.1
- **安全框架**：Spring Security 6
- **认证方式**：JWT Token
- **缓存**：Redis
- **数据库**：MySQL 8.0
- **接口文档**：Swagger/Knife4j
- **工具库**：Lombok、Hutool、Apache Commons

#### 3.2 系统架构

- **分层架构**：控制器层 → 服务层 → 数据访问层 → 数据库
- **模块化设计**：按功能划分为多个独立模块
- **RESTful API**：遵循RESTful设计规范
- **统一响应**：使用Result类封装所有接口响应
- **异常处理**：全局异常处理器统一处理异常

### 4. 接口设计

#### 4.1 接口风格

- RESTful风格，使用HTTP方法对应CRUD操作
- 路径前缀统一，如/api/admin/xxx、/api/student/xxx
- 参数验证使用Bean Validation
- 错误处理统一，返回标准错误码和错误信息

#### 4.2 核心接口

- **认证接口**：/auth/login、/auth/register、/auth/refresh
- **用户接口**：/admin/user/list、/student/user/profile
- **自习室接口**：/admin/room/create、/api/room/list
- **预约接口**：/student/reservation/create、/admin/reservation/list
- **签到接口**：/student/checkin/in、/student/checkin/out
- **统计接口**：/admin/statistics/system、/admin/statistics/room/usage

### 5. 数据库设计

#### 5.1 核心表结构

- **用户表**：存储用户基本信息
- **房间表**：存储自习室信息
- **座位表**：存储座位信息
- **预约表**：存储预约记录
- **签到表**：存储签到记录
- **违规表**：存储违规记录
- **公告表**：存储公告信息
- **系统设置表**：保存系统设置

#### 5.2 数据关系

- **用户与预约**：一对多（一个用户可创建多个预约）
- **用户与签到**：一对多（一个用户可进行多次签到）
- **用户与违规**：一对多（一个用户可能有多个违规记录）
- **自习室与座位**：一对多（一个自习室包含多个座位）
- **自习室与预约**：一对多（一个自习室可被预约多次）
- **座位与预约**：一对多（一个座位可被预约多次）
- **预约与签到**：一对一（一个预约对应一次签到）
- **预约与违规**：一对一（一个预约可能对应一次违规）

#### 5.3 核心数据表

| 表名              | 描述       | 关键字段                                                     |
| ----------------- | ---------- | ------------------------------------------------------------ |
| `users`           | 用户表     | id, username, realName, email, password, role, status, creditScore |
| `rooms`           | 自习室表   | id, name, code, building, floor, capacity, status, openTime, closeTime |
| `seats`           | 座位表     | id, roomId, seatNumber, type, status, position               |
| `reservations`    | 预约表     | id, userId, roomId, seatId, startTime, endTime, status, reservationNo |
| `check_ins`       | 签到表     | id, reservationId, userId, checkInTime, checkOutTime, checkInMethod |
| `violations`      | 违规表     | id, userId, reservationId, type, description, deductCredit   |
| `announcements`   | 公告表     | id, title, content, type, publishTime, publisher, isActive   |
| `system_settings` | 系统设置表 | id, key, value, description, updatedAt                       |
| `system_logs`     | 系统日志表 | id, level, message, timestamp, userId, ip, userAgent         |



### 6. 系统特点

#### 6.1 安全性

- JWT Token认证
- 密码MD5加密
- 权限控制
- SQL注入防护

#### 6.2 可靠性

- 事务管理
- 异常处理
- 数据验证
- 日志记录

#### 6.3 可扩展性

- 模块化设计
- 接口标准化
- 配置外部化
- 易于添加新功能

#### 6.4 性能优化

- Redis缓存
- 数据库索引
- 批量操作
- 异步处理
