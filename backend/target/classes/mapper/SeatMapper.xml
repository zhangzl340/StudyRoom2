<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.studyroom.mapper.SeatMapper">

    <!-- 基础结果映射 -->
    <resultMap id="BaseResultMap" type="com.studyroom.entity.Seat">
        <id property="id" column="id" />
        <result property="roomId" column="room_id" />
        <result property="seatNumber" column="seat_number" />
        <result property="type" column="type" />
        <result property="status" column="status" />
        <result property="position" column="position" />
        <result property="createdAt" column="created_at" />
        <result property="updatedAt" column="updated_at" />
    </resultMap>

    <!-- 根据自习室ID查询座位 -->
    <select id="selectByRoomId" resultMap="BaseResultMap">
        SELECT * FROM seats WHERE room_id = #{roomId} ORDER BY seat_number
    </select>

    <!-- 根据自习室ID查询可用座位 -->
    <select id="selectAvailableSeatsByRoomId" resultMap="BaseResultMap">
        SELECT s.* FROM seats s
        WHERE s.room_id = #{roomId}
          AND s.status = 'available'
        ORDER BY s.seat_number
    </select>

    <!-- 根据自习室ID和座位号查询座位 -->
    <select id="selectByRoomIdAndSeatNumber" resultMap="BaseResultMap">
        SELECT * FROM seats
        WHERE room_id = #{roomId} AND seat_number = #{seatNumber}
    </select>

    <!-- 根据状态查询座位 -->
    <select id="selectByStatus" resultMap="BaseResultMap">
        SELECT * FROM seats WHERE status = #{status} ORDER BY room_id, seat_number
    </select>

    <!-- 根据类型查询座位 -->
    <select id="selectByType" resultMap="BaseResultMap">
        SELECT * FROM seats WHERE type = #{type} ORDER BY room_id, seat_number
    </select>

</mapper>